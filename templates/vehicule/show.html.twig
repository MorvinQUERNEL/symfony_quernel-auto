{% extends 'base.html.twig' %}

{% block title %}{{ vehicule.brand }} {{ vehicule.model }} - Quernel Auto{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/vehicules.css') }}">
    <link rel="stylesheet" href="{{ asset('css/vehicule-detail.css') }}">
{% endblock %}

{% block body %}
<article class="vehicule-detail-page">
    <header class="detail-page-header">
        <div class="header-content">
            <nav class="breadcrumb">
                <a href="{{ path('app_vehicules_index') }}" class="back-link"><i class="fas fa-arrow-left"></i> Retour au catalogue</a>
            </nav>
            <h1>{{ vehicule.brand }} {{ vehicule.model }}</h1>
            <p class="header-year">{{ vehicule.year|date('Y') }}</p>
        </div>
    </header>

    <div class="vehicule-detail-layout">
        <!-- Colonne de la galerie d'images -->
        <section class="gallery-container" aria-labelledby="gallery-title">
            <h2 id="gallery-title" class="sr-only">Galerie photos</h2>
            <div class="main-image-wrapper">
                 {% if vehicule.pictures is not empty %}
                    <img src="{{ asset('uploads/vehicules/' ~ vehicule.pictures.first.name) }}" alt="Vue principale de {{ vehicule.brand }} {{ vehicule.model }}" id="main-image">
                {% else %}
                    <div class="no-image-placeholder-detail"><i class="fas fa-car-side"></i></div>
                {% endif %}
            </div>
            {% if vehicule.pictures|length > 1 %}
                <div class="thumbnail-gallery" id="thumbnail-gallery">
                    {% for picture in vehicule.pictures %}
                        <div class="thumbnail-item {{ loop.first ? 'active' : '' }}" data-image-url="{{ asset('uploads/vehicules/' ~ picture.name) }}">
                            <img src="{{ asset('uploads/vehicules/' ~ picture.name) }}" alt="Miniature {{ loop.index }}">
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </section>

        <!-- Colonne des informations -->
        <aside class="info-container">
            <section class="info-block price-block" aria-labelledby="price-title">
                <h3 id="price-title" class="price-label">Prix</h3>
                <p class="price">{{ (vehicule.salePrice / 100)|number_format(0, ',', ' ') }} €</p>
                 {% if vehicule.status == 'Disponible' %}
                    <a href="{{ path('app_orders_new_with_vehicule', {'vehicule_id': vehicule.id}) }}" class="btn-buy"><i class="fas fa-shopping-cart"></i> Acheter ce véhicule</a>
                {% else %}
                    <p class="status-badge-detail {{ vehicule.status|lower|replace({' ': '-'}) }}">
                        {{ vehicule.status }}
                    </p>
                {% endif %}
            </section>

            <section class="info-block specs-block" aria-labelledby="specs-title">
                <h4 id="specs-title"><i class="fas fa-list-ul"></i> Caractéristiques</h4>
                <dl class="specs-grid">
                    <div class="spec-item">
                        <dt class="spec-label">Kilométrage</dt>
                        <dd class="spec-value">{{ vehicule.mileage|number_format(0, ',', ' ') }} km</dd>
                    </div>
                    <div class="spec-item">
                        <dt class="spec-label">Carburant</dt>
                        <dd class="spec-value">{{ vehicule.fuelType }}</dd>
                    </div>
                    <div class="spec-item">
                        <dt class="spec-label">Transmission</dt>
                        <dd class="spec-value">{{ vehicule.trasmission }}</dd>
                    </div>
                    <div class="spec-item">
                        <dt class="spec-label">Couleur</dt>
                        <dd class="spec-value">{{ vehicule.color }}</dd>
                    </div>
                    <div class="spec-item">
                        <dt class="spec-label">Portes</dt>
                        <dd class="spec-value">{{ vehicule.doorCount }}</dd>
                    </div>
                </dl>
            </section>

            {% if vehicule.description %}
            <section class="info-block description-block" aria-labelledby="desc-title">
                <h4 id="desc-title"><i class="fas fa-align-left"></i> Description</h4>
                <p>{{ vehicule.description|nl2br }}</p>
            </section>
            {% endif %}
        </aside>
    </div>
</article>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/vehicule_detail.js') }}" defer></script>
{% endblock %} 