{% extends 'base.html.twig' %}

{% block title %}Quernel Auto - Import/Export de véhicules{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ asset('css/home.css') }}">
{% endblock %}

{% block body %}
    <!-- Section Hero -->
    <header class="hero">
        <div class="hero-content">
            <h1>QUERNEL AUTO</h1>
            <p>QUERNEL AUTO simplifie l'import-export de voitures, offrant des solutions fiables et transparentes pour l'achat et la vente de véhicules à l'international. Avec une expertise reconnue et un réseau mondial, nous vous accompagnons à chaque étape pour rendre vos transactions automobiles fluides et sécurisées.</p>
            {% if app.user %}
                <a href="{{ path('app_preference_add') }}" class="cta-button">Ajouter une préférence</a>
            {% else %}
                <a href="{{ path('app_combined_form') }}" class="cta-button">Remplir un formulaire</a>
            {% endif %}
        </div>
    </header>

    <!-- Section Services -->
    <section class="services" aria-labelledby="services-title">
        <h2 id="services-title">Nos Services</h2>
        <div class="services-grid">
            <article class="service-card">
                <i class="fas fa-car"></i>
                <h3>Import de Véhicules</h3>
                <p>Solutions personnalisées pour l'importation de véhicules de qualité</p>
            </article>
            <article class="service-card">
                <i class="fas fa-globe"></i>
                <h3>Export International</h3>
                <p>Expertise mondiale dans l'exportation de véhicules</p>
            </article>
            <article class="service-card">
                <i class="fas fa-handshake"></i>
                <h3>Accompagnement</h3>
                <p>Support complet tout au long du processus</p>
            </article>
        </div>
    </section>

    <!-- Section Processus -->
    <section class="process" aria-labelledby="process-title">
        <h2 id="process-title">Notre Processus d'Importation</h2>
        <div class="process-steps">
            {% for i in 1..4 %}
                <article class="step">
                    <img src="{{ asset('images/etape' ~ i ~ '.jpg') }}" alt="Étape {{ i }}">
                    <h3>Étape {{ i }}</h3>
                    <p>{{ {
                        1: 'Sélection du véhicule selon vos critères',
                        2: 'Vérification et inspection complète',
                        3: 'Transport sécurisé',
                        4: 'Livraison et formalités administratives'
                    }[i] }}</p>
                </article>
            {% endfor %}
        </div>
    </section>

    <!-- Section Véhicules Récents -->
    {% if recentVehicules is not empty %}
    <section class="recent-vehicles" aria-labelledby="recent-vehicles-title">
        <header class="recent-vehicles__header">
            <h2 id="recent-vehicles-title" class="recent-vehicles__title">Nos véhicules du moment</h2>
            <p class="recent-vehicles__subtitle">Découvrez notre sélection de véhicules récents, prêts à être importés.</p>
        </header>
        <div class="vehicles-carousel">
            <!-- Flèches de navigation -->
            <button class="carousel-nav carousel-nav-prev" aria-label="Véhicule précédent">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="carousel-nav carousel-nav-next" aria-label="Véhicule suivant">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <!-- Wrapper pour le swipe -->
            <div class="carousel-wrapper">
                <div class="vehicles-track">
                    {% for vehicule in recentVehicules %}
                        <article class="vehicle-card">
                            <div class="vehicle-image">
                                {% if vehicule.pictures is not empty and vehicule.pictures|first.name %}
                                    <img src="{{ asset('uploads/vehicules/' ~ vehicule.pictures|first.name) }}" alt="{{ vehicule.brand }} {{ vehicule.model }}">
                                {% else %}
                                    <img src="{{ asset('images/logo_quernel_auto.png') }}" alt="Aucune image disponible pour {{ vehicule.brand }} {{ vehicule.model }}">
                                {% endif %}
                                <div class="vehicle-image__overlay"></div>
                            </div>
                            <div class="vehicle-content">
                                <h3 class="vehicle-title">{{ vehicule.brand }} {{ vehicule.model }}</h3>
                                <p class="vehicle-description">{{ vehicule.description|length > 100 ? vehicule.description|slice(0, 100) ~ '...' : vehicule.description }}</p>
                                <div class="vehicle-details">
                                    <div class="vehicle-detail-item">
                                        <i class="fas fa-calendar"></i>
                                        <span>{{ vehicule.year ? vehicule.year|date('Y') : 'N/A' }}</span>
                                    </div>
                                    <div class="vehicle-detail-item">
                                        <i class="fas fa-gas-pump"></i>
                                        <span>{{ vehicule.fuelType }}</span>
                                    </div>
                                </div>
                                <div class="vehicle-price">{{ (vehicule.salePrice / 100)|number_format(0, ',', ' ') }} €</div>
                                <div class="vehicle-actions">
                                    <a href="{{ path('app_vehicules_show', {'id': vehicule.id}) }}" class="btn-vehicle btn-view">
                                        Voir les détails
                                    </a>
                                    {% if vehicule.status == 'Disponible' %}
                                        <a href="{{ path('app_vehicules_buy', {'id': vehicule.id}) }}" class="btn-vehicle btn-buy">
                                            <i class="fas fa-credit-card"></i>
                                            Acheter
                                        </a>
                                    {% endif %}
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            </div>
            
            <!-- Indicateurs de pagination -->
            <div class="carousel-indicators">
                {# The number of dots is handled by the JS, this is just for server-side rendering #}
                {% set itemsPerPage = 1 %} 
                {% set totalPages = (recentVehicules|length / itemsPerPage)|round(0, 'ceil') %}
                {% for i in 0..(totalPages - 1) %}
                    <button class="carousel-dot{% if i == 0 %} active{% endif %}" data-page="{{ i }}" aria-label="Page {{ i + 1 }}"></button>
                {% endfor %}
            </div>

            <!-- Barre de progression -->
            <div class="carousel-progress">
                <div class="carousel-progress-bar"></div>
            </div>
        </div>
    </section>
    {% endif %}
{% endblock %}

{% block page_javascripts %}
    {# Le carrousel s'initialise automatiquement via carousel.js qui est chargé dans base.html.twig #}
{% endblock %}

